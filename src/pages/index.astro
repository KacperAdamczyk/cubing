---
import SetList, { type Items } from "@/components/SetList.astro";
import SummaryTable from "@/components/SummaryTable.astro";
import { getBreadcrumbs } from "@/helpers/getBreadcrumbs";
import Layout from "@/layouts/Layout.astro";
import { getSetCases } from "@/queries/getSetCases";
import { getCollection } from "astro:content";

const sets = await getCollection("sets");
const allCases = await getCollection("cases");

const items: Items = await Promise.all([
  {
    href: "/",
    name: "All",
    previewAlgorithm: "",
    size: allCases.length,
    viewType: "PLL",
  },
  ...sets.map(async ({ data: set }) => ({
    href: `/${set.id}`,
    name: set.name,
    previewAlgorithm: "",
    size: (await getSetCases(set.id)).length,
    viewType: set.viewType,
  })),
]);
---

<Layout breadcrumbs={getBreadcrumbs()}>
  <SetList items={items} />
  <SummaryTable />
</Layout>
